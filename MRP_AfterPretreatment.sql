

/********************************* 
作者：
		yanx

创建日期：
		2011-11-08

功能描述：
      	预处理后事件

-------------------------------------------------------------------------------------------

修改者：
		
-------------------------------------------------------------------------------------------

传入参数：
    	@PlanVersion
			数据类型：bigint
			描述：计划版本

		@WorkCalendar	
			数据类型：bigint
			描述：工作日历

		@Partition	
			数据类型：int
			描述：分区，可忽略此参数。


*********************************/
GO

/****** Object:  StoredProcedure [dbo].[P_Cust_WeekPlan]    Script Date: 2020/7/20 17:17:51 ******/
if object_id(N'MRP_AfterPretreatment',N'P') is not null
 drop proc MRP_AfterPretreatment

GO

/****** Object:  StoredProcedure [dbo].[P_Cust_WeekPlan]    Script Date: 2020/7/20 17:17:51 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


CREATE PROCEDURE [dbo].[MRP_AfterPretreatment]
(	
	@PlanVersion  bigint,
	@WorkCalendar bigint,
	@Partition    int
)
AS
BEGIN
		
	SET NOCOUNT ON;

/**********************************************************************************************************
-------------------------------------参数定义开始----------------------------------------------------------
**********************************************************************************************************/
	Declare @PlanMethod					int
	declare @StartDate                  datetime
	declare @EndDate                    datetime
	declare @CurrentDate					datetime
	 
/**********************************************************************************************************
-------------------------------------参数定义结束----------------------------------------------------------
**********************************************************************************************************/

/**********************************************************************************************************
-------------------------------------获取参数开始----------------------------------------------------------
**********************************************************************************************************/

	Select 
		@PlanMethod = B.[PlanMethod],@StartDate = B.[StartDate]
	from MRP_PlanVersion A 
		inner join MRP_PlanName B on A.[PlanName] = B.[ID]
	Where A.[ID] = @PlanVersion;

	if (@@rowcount = 0)
	Begin
		return;
	End
	
	set @CurrentDate = Convert(date,GETDATE());
	
/**********************************************************************************************************
-------------------------------------获取参数结束----------------------------------------------------------
**********************************************************************************************************/

/**********************************************************************************************************
-------------------------------------创建处理日志----------------------------------------------------------
**********************************************************************************************************/

    --业务处理可写在此处
    update MRP_BOMMapping_Temp set IssueStyle = 0 where planversion = @planversion and  IssueStyle = 4
    

END

